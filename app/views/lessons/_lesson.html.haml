.lesson
  .lesson-topic{class: lesson_topic_class(lesson)}
    =image_tag(lesson.topic.pictotype('medium'), class:'lesson-picto')
  .lesson-other
    =image_tag(lesson.other(current_user).avatar(:medium), class:'lesson-user')
  .lesson-details
    .lesson-details-left.pull-left
      .lesson-duration
        - if lesson.upcoming?
          Prévu dans #{distance_of_time_in_words(Time.now, lesson.time_start, include_seconds: true)}
        - else
          Il y a #{time_ago_in_words(lesson.time_end, include_seconds: true)}
        %small (le #{lesson.time_end.strftime('%d/%m/%Y')})
      .lesson-date
        #{lesson_duration(lesson.time_start, lesson.time_end)} de
        %span.text-purple
          #{lesson.topic.title}
        avec #{link_to lesson.other(current_user).name, user_path(lesson.other(current_user)), class:'text-purple'}
    .lesson-details-right.pull-right
      .lesson-actions
        -case partial_action(lesson)
          -when 'pending'
            .pending
              Confirmer le cours ?
              %br
              = link_to 'confirmer', lesson_accept_path(lesson), class: 'btn btn-qw btn-green btn-sm'
              = link_to 'modifier', edit_lesson_path(lesson), class: 'btn btn-qw btn-orange btn-sm'
              = link_to 'refuser', lesson_refuse_path(lesson), class: 'text-grey'
          -when 'show_pending'
            .show-pending
            .show-pending
              En attente de la confirmation de l'autre partie.
              %br
              = link_to 'annuler la demande', lesson_cancel_path(lesson), class: 'btn btn-qw btn-grey btn-sm'
          -when 'expired'
            .expired Cette propositionde cours a expiré!
          -when 'payment'
            .payment
              Votre cours s'est-il bien passé ?
              %br
              = link_to 'Oui!', lesson_debloquerpayment_path(lesson) , class:'btn btn-qw btn-green btn-sm'
              = link_to 'non', lesson_bloquerpayment_path(lesson), class: 'text-pink'
          -when 'wait_payment'
            .wait-payment
              Nous attendons la confirmation de l'élève avant de débloquer le payement.
          -when 'review'
      .lesson-show-details
        =link_to 'détails', lesson_path(lesson), class: 'text-pink'

    .lesson-status
      .confirmation-status
        -case lesson_confirmation_status(lesson)
          - when 'created'
            %i.fa.fa-check.text-green
            %br
            %small confirmé
          - when 'pending'
            %i.fa.fa-question.text-purple
            %br
            %small en attente
          - when 'canceled'
            %i.fa.fa-times.text-grey
            %br
            %small annulé
      .payment-status
        -case lesson_payment_status(lesson)
          -when 'paid'
            %i.fa.fa-dollar.text-green
            %br
            %small payé
          -when 'prepaid'
            %i.fa.fa-dollar.text-grey
            %br
            %small pré-payé
          - when 'unpaid'
            %i.fa.fa-dollar.text-orange
            %br
            %small non payé
.lesson-details{id: "lesson-details-#{lesson.id}"}